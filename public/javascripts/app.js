(function(){"use strict";var t="undefined"!=typeof window?window:global;if("function"!=typeof t.require){var e={},n={},i=function(t,e){return{}.hasOwnProperty.call(t,e)},r=function(t,e){var n,i,r=[];n=/^\.\.?(\/|$)/.test(e)?[t,e].join("/").split("/"):e.split("/");for(var o=0,s=n.length;s>o;o++)i=n[o],".."===i?r.pop():"."!==i&&""!==i&&r.push(i);return r.join("/")},o=function(t){return t.split("/").slice(0,-1).join("/")},s=function(e){return function(n){var i=o(e),s=r(i,n);return t.require(s)}},a=function(t,e){var i={id:t,exports:{}};e(i.exports,s(t),i);var r=n[t]=i.exports;return r},l=function(t){var o=r(t,".");if(i(n,o))return n[o];if(i(e,o))return a(o,e[o]);var s=r(o,"./index");if(i(n,s))return n[s];if(i(e,s))return a(s,e[s]);throw Error('Cannot find module "'+t+'"')},u=function(t,n){if("object"==typeof t)for(var r in t)i(t,r)&&(e[r]=t[r]);else e[t]=n};t.require=l,t.require.define=u,t.require.register=u,t.require.brunch=!0}})(),window.require.register("application",function(t,e,n){Application={initialize:function(){var t=e("models/list");this.list=new t;var n=e("views/nav_view");this.navView=new n({collection:this.list});var i=e("views/display_view");this.displayView=new i({collection:this.list});var r=e("models/player");this.player=new r({model:this.list});var o=e("views/control_view");this.controlView=new o({model:this.player}),"function"==typeof Object.freeze&&Object.freeze(this)}},n.exports=Application}),window.require.register("initialize",function(t,e){var n=e("application");$(function(){$("head").append('<script src="https://www.youtube.com/iframe_api?modestbranding=1&autoplay=1"></script>'),n.initialize(),Backbone.history.start()})}),window.require.register("lib/router",function(t,e,n){var i=e("application");n.exports=Backbone.Router.extend({routes:{"":"home"},home:function(){$("body").html(i.homeView.render().el)}})}),window.require.register("lib/view_helper",function(){}),window.require.register("models/list",function(t,e,n){n.exports=Backbone.Collection.extend({initialize:function(){this.current=-1,this.on("add",function(){-1===this.current&&(this.current=0)}),this.on("remove",function(){this.isEmpty()}),this.on("reset",function(){this.isEmpty()})},isEmpty:function(){0===this.length&&(this.current=-1)},next:function(){var t=this.length;if(0===t)return-1;if(t>this.current+1)for(var e=this.current+1;t>=e;e++){if(this.at(e)===void 0)return-1;if(this.at(e).get("inc")===!0)return this.current=e,e}},prev:function(){var t=this.length;if(0===t)return-1;if(this.current-1>-1)for(var e=this.current-1;e>-1;e--){if(this.at(e)===void 0)return-1;if(this.at(e).get("inc")===!0)return this.current=e,e}},inc:function(t){var e=this.get(t);return e.get("inc")?e.set("inc",!1):e.set("inc",!0),e},total:function(){var t=0;return this.each(function(e){e.get("inc")&&t++}),t}})}),window.require.register("models/player",function(t,e,n){e("./list"),n.exports=Backbone.Model.extend({defaults:{width:200,height:200,state:-1},initialize:function(){var t=this;window.onYouTubeIframeAPIReady=function(){t.createPlayer()}},createPlayer:function(){var t=$("#player"),e=this;e.YTPlayer=new YT.Player(t[0],{height:e.get("height"),width:e.get("width"),events:{onStateChange:e.stateChanged.bind(e)}})},stateChanged:function(t){switch(this.set("state",t.data),console.log(this.get("state")),this.get("state")){case-1:break;case 0:this.next(),this.play();break;case 1:break;case 2:break;case 3:break;case 5:}},load:function(){var t=this.get("model"),e=t.current,n=t.at(e);n!==void 0&&this.YTPlayer.cueVideoById(n.get("videoId"))},play:function(){this.YTPlayer.playVideo()},unload:function(){this.get("state")!==void 0&&-1!==this.get("state")&&this.YTPlayer.cueVideoById("")},next:function(){var t=this.get("model");t.next(),this.load(),this.play()},prev:function(){var t=this.get("model");t.prev(),this.load(),this.play()},mute:function(){this.get("state")!==void 0&&-1!==this.get("state")&&(this.YTPlayer.isMuted()?this.YTPlayer.unMute():this.YTPlayer.mute())}})}),window.require.register("models/song",function(t,e,n){n.exports=Backbone.Model.extend({defaults:{favCount:0,viewCount:0,thumb:"",inc:!1}})}),window.require.register("views/control_view",function(t,e,n){var i=e("./templates/control");n.exports=Backbone.View.extend({el:$("#control"),template:i,events:{"click #playBtn":"play","click #prevBtn":"prev","click #loadBtn":"loadClicked","click #nextBtn":"next","click #muteBtn":"mute"},initialize:function(){this.render();var t=this,e=this.model.get("model");e.bind("change:inc",function(){t.model.load()}),e.bind("reset",function(){t.model.unload()})},render:function(){return this.$el.html(this.template),this},play:function(){this.model.play()},next:function(){this.model.next()},prev:function(){this.model.prev()}})}),window.require.register("views/display_view",function(t,e,n){var i=e("views/song_view"),r=e("./templates/display");n.exports=Backbone.View.extend({el:$("#display"),elm:"displayTable",template:r,initialize:function(){if(this.render(),this.collection!==void 0){var t=this;this.collection.bind("add",function(e){t.renderEach(e)}),this.collection.bind("remove",function(){t.render()}),this.collection.bind("reset",function(){t.render()})}},events:{"click #deleteAllBtn":"deleteAll","click #addAllBtn":"addAll"},render:function(){if(this.$el.html(this.template),this.collection!==void 0){var t=this;_.each(this.collection.models,function(e){t.renderEach(e)})}return this},renderEach:function(t){var e=new i({model:t});$("#"+this.elm).append(e.render().el)},deleteAll:function(){this.collection.reset()},addAll:function(){this.collection.each(function(t){t.set("inc",!0),$(".song").css("background","rgb( 36, 42, 47 )").find("#add i").removeClass("icon-plus-sign").addClass("icon-minus-sign")})}})}),window.require.register("views/nav_view",function(t,e,n){var i=e("models/song"),r=e("./templates/nav");n.exports=Backbone.View.extend({el:$("#nav"),template:r,events:{"click #searchBtn":"getSongs","keypress input[type=text]":"onReturn","click #relevanceBtn":"setRelevance","click #viewCountBtn":"setViewCount","click #publishedBtn":"setPublished"},initialize:function(){this.render(),this.searchBy="viewCount"},render:function(){return this.$el.html(this.template),this},onReturn:function(t){13===t.keyCode&&this.getSongs()},getData:function(t){var e=this.buildUrl();$.getJSON(e,function(e){var n=e.feed.entry;t(n)})},buildUrl:function(t){var e="http://gdata.youtube.com/feeds/api/videos?alt=json";return e+="&q="+this.search,"viewCount"===this.searchBy?e+="&orderby=viewCount":"published"===this.searchBy&&(e+="&orderby=published"),t&&(e+="&start-index=25"),e},getSongs:function(){var t=this;this.search=_.escape($("#searchBox").val()),this.getData(function(e){for(var n=0;e.length>n;n++){var r=e[n],o=new i,s=/[a-zA-Z0-9\-\_]{11}/,a=r.link[0].href;o.set("videoId",a.match(s)[0]),o.set("title",r.title.$t),o.set("author",r.author[0].name.$t),o.set("date",r.published.$t);var l=t.timeFormat(r.media$group.yt$duration.seconds);if(o.set("duration",l),r.yt$statistics===void 0)o.set("viewCount",0),o.set("favCount",0);else{var u=t.countFormat(r.yt$statistics.viewCount);o.set("viewCount",u||0),o.set("favCount",r.yt$statistics.favoriteCount||0)}r.media$group.media$thumbnail[0].url!==void 0&&o.set("thumb",r.media$group.media$thumbnail[0].url),t.collection.add(o)}})},setRelevance:function(){this.searchBy="relevance",$("#searchByIcon").removeClass("icon-calendar").removeClass("icon-eye-open").addClass("icon-zoom-in")},setViewCount:function(){this.searchBy="viewCount",$("#searchByIcon").removeClass("icon-calendar").removeClass("icon-zoom-in").addClass("icon-eye-open")},setPublished:function(){this.searchBy="published",$("#searchByIcon").removeClass("icon-zoom-in").removeClass("icon-eye-open").addClass("icon-calendar")},timeFormat:function(t){var e=Number(t),n=Math.floor(e/3600),i=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(n>0?n+":":"")+(i>0?(n>0&&10>i?"0":"")+i+":":"0:")+(10>r?"0":"")+r},countFormat:function(t){return(""+t).replace(/\B(?=(\d{3})+(?!\d))/g,",")}})}),window.require.register("views/song_view",function(t,e,n){var i=e("./templates/song");n.exports=Backbone.View.extend({className:"song",template:i,initialize:function(){this.render();var t=this;this.$el.click(function(){t.add()})},render:function(){return this.$el.html(this.template(this.model.toJSON())),this},events:{"click #play":"play","click #add":"add"},play:function(){this.model.set("inc",!0)},add:function(){this.model.get("inc")?(this.$el.find("#add i").removeClass("icon-minus-sign").addClass("icon-plus-sign"),this.$el.css("background","none"),this.model.set("inc",!1)):(this.$el.find("#add i").removeClass("icon-plus-sign").addClass("icon-minus-sign"),this.$el.css("background","rgb( 36, 42, 47 )"),this.model.set("inc",!0))}})}),window.require.register("views/templates/control",function(t,e,n){n.exports=Handlebars.template(function(t,e,n,i,r){return this.compilerInfo=[3,">= 1.0.0-rc.4"],n=n||t.helpers,r=r||{},'<div class="navbar navbar-fixed-bottom navbar-inverse">\n  	<div class="navbar-inner">\n  		<div class="container">\n			<ul class="nav">\n				<li><span id="prevBtn" class="player"><i class="icon-step-backward icon-4x"></i></span></li>\n				<li><div id="player"></div></li>\n				<li><span id="nextBtn" class="player"><i class="icon-step-forward icon-4x"></i></i></span></li>\n			</ul>\n		</div>\n	</div>\n</div>'})}),window.require.register("views/templates/display",function(t,e,n){n.exports=Handlebars.template(function(t,e,n,i,r){return this.compilerInfo=[3,">= 1.0.0-rc.4"],n=n||t.helpers,r=r||{},'<div id=\'displayControl\'>\n\n	<div class="container">\n\n		<button id="addAllBtn" class="btn"><i class="icon-plus"></i> Add All</button>\n\n		<button id="deleteAllBtn" class="btn"><i class="icon-trash"></i> Delete All</button>\n	\n		<a id="tweet" href="http://twitter.com/dunckr"><span class="icon-twitter icon-large pull-right"></span></a>\n\n	</div>\n</div>\n\n<div class="container">\n\n	<table id="displayTable" class="table">\n	</table>\n</div>'})}),window.require.register("views/templates/nav",function(t,e,n){n.exports=Handlebars.template(function(t,e,n,i,r){return this.compilerInfo=[3,">= 1.0.0-rc.4"],n=n||t.helpers,r=r||{},'<div class="navbar navbar-fixed-top navbar-inverse">\n  <div class="navbar-inner">\n\n    <div class="container">\n      <img src="/images/logo.png" alt="">\n      <a class="brand" href="#">shuffi</a>\n      <ul class="nav">\n        <li>\n          <div class="controls">\n            \n            <div class="navbar-search input-append">\n              <input id="searchBox" type="text" placeholder=\'e.g. chillstep mix\' autofocus>\n\n              <i class="icon-search"></i>\n              <button id="searchBtn" type="submit" class="btn btn-inverse"><i id="searchByIcon" class="icon-eye-open"></i></button>\n              \n              \n              <a class="btn btn-primary btn-inverse dropdown-toggle" data-toggle="dropdown" href="#"><span class="icon-chevron-down"></span></a>\n              <ul class="dropdown-menu">\n                <li><span id="relevanceBtn" href=""><i class="icon-zoom-in"></i> Relevance</span></li>\n                <li><span id="viewCountBtn"><i class="icon-eye-open"></i> View Count</span></li>\n                <li><span id="publishedBtn"><i class="icon-calendar"></i> Published</span></li>\n              </ul>\n            </div>\n\n          </div>\n        </li>\n      </ul>\n  	</div>\n  </div>\n</div>\n'})}),window.require.register("views/templates/song",function(t,e,n){n.exports=Handlebars.template(function(t,e,n,i,r){this.compilerInfo=[3,">= 1.0.0-rc.4"],n=n||t.helpers,r=r||{};var o,s="",a="function",l=this.escapeExpression;return s+='<tr>\n	<td class="span1"><span id="add"><i class="icon-plus-sign icon-2x"></i></span></td>\n	<td class="span1"><img src="',(o=n.thumb)?o=o.call(e,{hash:{},data:r}):(o=e.thumb,o=typeof o===a?o.apply(e):o),s+=l(o)+'" alt="',(o=n.title)?o=o.call(e,{hash:{},data:r}):(o=e.title,o=typeof o===a?o.apply(e):o),s+=l(o)+'"></td>\n	<td class="span7">',(o=n.title)?o=o.call(e,{hash:{},data:r}):(o=e.title,o=typeof o===a?o.apply(e):o),s+=l(o)+'</td>\n	<td class="span1">',(o=n.author)?o=o.call(e,{hash:{},data:r}):(o=e.author,o=typeof o===a?o.apply(e):o),s+=l(o)+'</td>\n	<td class="span1">',(o=n.duration)?o=o.call(e,{hash:{},data:r}):(o=e.duration,o=typeof o===a?o.apply(e):o),s+=l(o)+'</td>\n	<td class="span2">',(o=n.viewCount)?o=o.call(e,{hash:{},data:r}):(o=e.viewCount,o=typeof o===a?o.apply(e):o),s+=l(o)+' <i class="icon-eye-open"></i></td>\n	<td class="span1">',(o=n.favCount)?o=o.call(e,{hash:{},data:r}):(o=e.favCount,o=typeof o===a?o.apply(e):o),s+=l(o)+' <i class="icon-heart"></i></td>\n</tr>'})});